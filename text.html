<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NguyeZ - Text Edit</title>
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', 'Helvetica Neue', Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Tab navigation */
        .tab-container {
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            padding: 0 40px;
        }

        .tabs {
            display: flex;
            gap: 0;
            max-width: 1200px;
            margin: 0 auto;
        }

        .tab {
            padding: 15px 25px;
            background: transparent;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            color: #6c757d;
        }

        .tab.active {
            color: #4facfe;
            border-bottom-color: #4facfe;
            background: white;
        }

        .tab:hover:not(.active) {
            color: #495057;
            background: rgba(79, 172, 254, 0.1);
        }

        /* Tab content */
        .tab-content {
            display: none;
            padding: 40px;
        }

        .tab-content.active {
            display: block;
        }

        /* Diff comparison styles */
        .diff-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .diff-panel {
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            overflow: hidden;
        }

        .diff-header {
            background: #f8f9fa;
            padding: 15px 20px;
            border-bottom: 1px solid #e1e5e9;
            font-weight: 600;
            color: #495057;
        }

        .diff-content {
            height: 300px;
            overflow-y: auto;
            font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
        }

        .diff-textarea {
            width: 100%;
            height: 100%;
            border: none;
            padding: 20px;
            resize: none;
            font-family: inherit;
            font-size: inherit;
            line-height: inherit;
        }

        .diff-textarea:focus {
            outline: none;
        }

        .diff-result {
            background: #f8f9fa;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            margin-top: 20px;
            overflow: hidden;
        }

        .diff-line {
            padding: 8px 20px;
            border-bottom: 1px solid #e9ecef;
            font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }

        .diff-line.added {
            background: #d4edda;
            color: #155724;
        }

        .diff-line.removed {
            background: #f8d7da;
            color: #721c24;
        }

        .diff-line.unchanged {
            background: #fff;
            color: #6c757d;
        }

        .diff-line:before {
            display: inline-block;
            width: 20px;
            margin-right: 10px;
            font-weight: bold;
        }

        .diff-line.added:before {
            content: '+';
            color: #28a745;
        }

        .diff-line.removed:before {
            content: '-';
            color: #dc3545;
        }

        .diff-line.unchanged:before {
            content: ' ';
        }

        /* Code editor styles */
        .code-editor-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .editor-panel {
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            overflow: hidden;
        }

        .editor-toolbar {
            background: #2d3748;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .language-select {
            background: #4a5568;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
        }

        .editor-content {
            position: relative;
            height: 400px;
            overflow: hidden;
        }

        .code-textarea {
            width: 100%;
            height: 100%;
            border: none;
            padding: 20px;
            background: #2d3748;
            color: #e2e8f0;
            font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            resize: none;
            tab-size: 4;
        }

        .code-textarea:focus {
            outline: none;
        }

        .code-preview {
            background: #1a202c;
            color: #e2e8f0;
            padding: 20px;
            font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            overflow-x: auto;
            white-space: pre;
        }

        /* File operations */
        .file-operations {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .file-input {
            display: none;
        }

        .file-label {
            display: inline-block;
            padding: 10px 20px;
            background: #6c757d;
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s ease;
        }

        .file-label:hover {
            background: #5a6268;
        }

        /* Find and replace */
        .find-replace {
            background: #f8f9fa;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .find-replace-row {
            display: grid;
            grid-template-columns: 1fr 1fr auto auto;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }

        .find-replace input {
            padding: 8px 12px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 14px;
        }

        .find-replace button {
            padding: 8px 16px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .find-replace button:hover {
            background: #0056b3;
        }

        .main-content {
            padding: 40px;
        }

        .text-areas {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .text-group {
            display: flex;
            flex-direction: column;
        }

        .text-group label {
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
            font-size: 1.1rem;
        }

        textarea {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            font-size: 14px;
            font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            line-height: 1.5;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .btn {
            padding: 12px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn.primary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .btn.success {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
        }

        .btn.warning {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #333;
        }

        .utility-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .copy-btn {
            background: linear-gradient(135deg, #48c6ef 0%, #6f86d6 100%);
        }

        .clear-btn {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            color: #333;
        }

        .stats {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 12px;
            color: white;
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            display: block;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .text-areas {
                grid-template-columns: 1fr;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .main-content {
                padding: 20px;
            }
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4caf50;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔤 NguyeZ - Text Edit</h1>
            <p>Chuyển đổi văn bản • So sánh • Code Editor • Và nhiều tính năng khác</p>
        </div>

        <div class="tab-container">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('transform')">🔤 Transform Text</button>
                <button class="tab" onclick="switchTab('diff')">🔍 So sánh văn bản</button>
                <button class="tab" onclick="switchTab('editor')">💻 Code Editor</button>
                <button class="tab" onclick="switchTab('tools')">🛠️ Tools</button>
            </div>
        </div>
        
        <!-- Transform Text Tab -->
        <div id="transform" class="tab-content active">
            <div class="text-areas">
                <div class="text-group">
                    <label for="inputText">📝 Văn bản gốc:</label>
                    <textarea 
                        id="inputText" 
                        placeholder="Nhập văn bản của bạn vào đây...&#10;&#10;Ví dụ: HELLO WORLD này là một văn bản thử nghiệm!"
                        oninput="updateStats()"
                    ></textarea>
                </div>
                
                <div class="text-group">
                    <label for="outputText">✨ Kết quả:</label>
                    <textarea 
                        id="outputText" 
                        placeholder="Kết quả sẽ hiển thị ở đây..."
                        readonly
                    ></textarea>
                </div>
            </div>
            
            <div class="controls">
                <button class="btn tooltip" onclick="transformText('lowercase')" data-tooltip="Chuyển tất cả thành chữ thường">
                    🔽 Chữ thường
                </button>
                
                <button class="btn tooltip" onclick="transformText('uppercase')" data-tooltip="Chuyển tất cả thành chữ in hoa">
                    🔼 CHỮ HOA
                </button>
                
                <button class="btn tooltip" onclick="transformText('capitalize')" data-tooltip="Viết hoa chữ cái đầu mỗi từ">
                    🎯 Viết Hoa Chữ Đầu
                </button>
                
                <button class="btn tooltip" onclick="transformText('sentence')" data-tooltip="Viết hoa chữ cái đầu câu">
                    📝 Viết hoa đầu câu
                </button>
                
                <button class="btn warning tooltip" onclick="transformText('strikethrough')" data-tooltip="Thêm gạch ngang qua chữ">
                    ̶G̶ạ̶c̶h̶ ̶n̶g̶a̶n̶g̶
                </button>
                
                <button class="btn warning tooltip" onclick="transformText('underline')" data-tooltip="Thêm gạch chân dưới chữ">
                    U̲n̲d̲e̲r̲l̲i̲n̲e̲
                </button>
                
                <button class="btn success tooltip" onclick="transformText('teencode')" data-tooltip="Chuyển sang teen code">
                    💬 Teen Code
                </button>
                
                <button class="btn success tooltip" onclick="transformText('reverse')" data-tooltip="Đảo ngược văn bản">
                    🔄 Đảo ngược
                </button>
                
                <button class="btn primary tooltip" onclick="transformText('removeAccents')" data-tooltip="Bỏ dấu tiếng Việt">
                    🚫 Bỏ dấu
                </button>
                
                <button class="btn primary tooltip" onclick="transformText('alternating')" data-tooltip="Xen kẽ chữ hoa thường">
                    🎭 xEn Kẽ
                </button>
                
                <button class="btn tooltip" onclick="transformText('removeSpaces')" data-tooltip="Xóa tất cả khoảng trắng">
                    🔗 Xóa khoảng trắng
                </button>
                
                <button class="btn tooltip" onclick="transformText('addSpaces')" data-tooltip="Thêm khoảng trắng giữa các ký tự">
                    ➕ T h ê m   k h o ả n g   t r ắ n g
                </button>
            </div>
            
            <div class="utility-controls">
                <button class="btn copy-btn" onclick="copyToClipboard()">
                    📋 Copy kết quả
                </button>
                
                <button class="btn clear-btn" onclick="clearAll()">
                    🗑️ Xóa tất cả
                </button>
                
                <button class="btn" onclick="swapText()">
                    🔄 Hoán đổi input/output
                </button>
            </div>
            
            <div class="stats">
                <h3>📊 Thống kê văn bản</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-number" id="charCount">0</span>
                        <span class="stat-label">Ký tự</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="wordCount">0</span>
                        <span class="stat-label">Từ</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="lineCount">0</span>
                        <span class="stat-label">Dòng</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="sentenceCount">0</span>
                        <span class="stat-label">Câu</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Diff Comparison Tab -->
        <div id="diff" class="tab-content">
            <h2>🔍 So sánh văn bản</h2>
            <p>So sánh sự khác biệt giữa hai văn bản giống như <a href="https://www.diffchecker.com/" target="_blank">Diffchecker</a></p>
            
            <div class="file-operations">
                <label class="file-label" for="diffFile1">📁 Mở file 1</label>
                <input type="file" id="diffFile1" class="file-input" onchange="loadFile('diffText1', this)">
                
                <label class="file-label" for="diffFile2">📁 Mở file 2</label>
                <input type="file" id="diffFile2" class="file-input" onchange="loadFile('diffText2', this)">
                
                <button class="btn" onclick="downloadDiff()">💾 Tải xuống kết quả</button>
                <button class="btn clear-btn" onclick="clearDiff()">🗑️ Xóa tất cả</button>
            </div>

            <div class="diff-container">
                <div class="diff-panel">
                    <div class="diff-header">📄 Văn bản gốc</div>
                    <div class="diff-content">
                        <textarea 
                            id="diffText1" 
                            class="diff-textarea"
                            placeholder="Nhập hoặc dán văn bản đầu tiên vào đây...&#10;&#10;Ví dụ:&#10;Xin chào thế giới&#10;Đây là dòng thứ hai&#10;Văn bản mẫu"
                            oninput="performDiff()"
                        ></textarea>
                    </div>
                </div>

                <div class="diff-panel">
                    <div class="diff-header">📄 Văn bản so sánh</div>
                    <div class="diff-content">
                        <textarea 
                            id="diffText2" 
                            class="diff-textarea"
                            placeholder="Nhập hoặc dán văn bản thứ hai vào đây...&#10;&#10;Ví dụ:&#10;Chào thế giới&#10;Đây là dòng thứ ba&#10;Văn bản mẫu mới"
                            oninput="performDiff()"
                        ></textarea>
                    </div>
                </div>
            </div>

            <div class="diff-result" id="diffResult">
                <div class="diff-header">📊 Kết quả so sánh</div>
                <div id="diffOutput" style="padding: 20px; color: #6c757d;">
                    Nhập văn bản vào cả hai ô phía trên để xem kết quả so sánh...
                </div>
            </div>
        </div>

        <!-- Code Editor Tab -->
        <div id="editor" class="tab-content">
            <h2>💻 Code Editor với Syntax Highlighting</h2>
            <p>Soạn thảo code với hỗ trợ syntax highlighting cho nhiều ngôn ngữ lập trình</p>
            
            <div class="file-operations">
                <label class="file-label" for="codeFile">📁 Mở file code</label>
                <input type="file" id="codeFile" class="file-input" onchange="loadCodeFile(this)">
                
                <button class="btn" onclick="downloadCode()">💾 Tải xuống code</button>
                <button class="btn" onclick="formatCode()">✨ Format code</button>
                <button class="btn" onclick="runCode()">▶️ Chạy code</button>
                <button class="btn clear-btn" onclick="clearCode()">🗑️ Xóa code</button>
            </div>

            <div class="code-editor-container">
                <div class="editor-panel">
                    <div class="editor-toolbar">
                        <span style="color: white; font-weight: 600;">📝 Editor</span>
                        <select id="languageSelect" class="language-select" onchange="changeLanguage()">
                            <option value="html">HTML</option>
                            <option value="css">CSS</option>
                            <option value="javascript">JavaScript</option>
                            <option value="python">Python</option>
                            <option value="json">JSON</option>
                            <option value="xml">XML</option>
                            <option value="sql">SQL</option>
                            <option value="php">PHP</option>
                            <option value="java">Java</option>
                            <option value="cpp">C++</option>
                            <option value="csharp">C#</option>
                            <option value="typescript">TypeScript</option>
                        </select>
                    </div>
                    <div class="editor-content">
                        <textarea 
                            id="codeEditor" 
                            class="code-textarea"
                            placeholder="Nhập code của bạn vào đây...&#10;&#10;HTML example:&#10;&lt;!DOCTYPE html&gt;&#10;&lt;html&gt;&#10;&lt;head&gt;&#10;    &lt;title&gt;Hello World&lt;/title&gt;&#10;&lt;/head&gt;&#10;&lt;body&gt;&#10;    &lt;h1&gt;Hello World!&lt;/h1&gt;&#10;&lt;/body&gt;&#10;&lt;/html&gt;"
                            oninput="updatePreview()"
                            onkeydown="handleTab(event)"
                        ></textarea>
                    </div>
                </div>

                <div class="editor-panel">
                    <div class="editor-toolbar">
                        <span style="color: white; font-weight: 600;">👁️ Preview / Output</span>
                        <button class="btn" onclick="copyCode()" style="padding: 4px 12px; font-size: 12px;">📋 Copy</button>
                    </div>
                    <div class="editor-content">
                        <div id="codePreview" class="code-preview">
                            <!-- Syntax highlighted code sẽ hiển thị ở đây -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tools Tab -->
        <div id="tools" class="tab-content">
            <h2>🛠️ Advanced Tools</h2>
            
            <div class="find-replace">
                <h3>🔍 Find & Replace</h3>
                <div class="find-replace-row">
                    <input type="text" id="findText" placeholder="Tìm kiếm...">
                    <input type="text" id="replaceText" placeholder="Thay thế bằng...">
                    <button onclick="findText()">🔍 Tìm</button>
                    <button onclick="replaceText()">🔄 Thay thế</button>
                </div>
                <div class="find-replace-row">
                    <label>
                        <input type="checkbox" id="regexMode"> Regex mode
                    </label>
                    <label>
                        <input type="checkbox" id="caseSensitive"> Case sensitive
                    </label>
                    <button onclick="replaceAll()">🔄 Thay thế tất cả</button>
                    <button onclick="highlightMatches()">🎯 Highlight</button>
                </div>
            </div>

            <div class="text-areas">
                <div class="text-group">
                    <label for="toolsInput">📝 Input Text:</label>
                    <textarea 
                        id="toolsInput" 
                        placeholder="Nhập văn bản để sử dụng các tools..."
                        style="height: 200px;"
                    ></textarea>
                </div>
                
                <div class="text-group">
                    <label for="toolsOutput">✨ Output:</label>
                    <textarea 
                        id="toolsOutput" 
                        placeholder="Kết quả sẽ hiển thị ở đây..."
                        style="height: 200px;"
                        readonly
                    ></textarea>
                </div>
            </div>

            <div class="controls">
                <button class="btn" onclick="extractEmails()">📧 Extract Emails</button>
                <button class="btn" onclick="extractUrls()">🔗 Extract URLs</button>
                <button class="btn" onclick="extractNumbers()">🔢 Extract Numbers</button>
                <button class="btn" onclick="wordFrequency()">📊 Word Frequency</button>
                <button class="btn" onclick="removeEmptyLines()">📝 Remove Empty Lines</button>
                <button class="btn" onclick="removeDuplicates()">🔄 Remove Duplicates</button>
                <button class="btn" onclick="sortLines()">📋 Sort Lines</button>
                <button class="btn" onclick="shuffleLines()">🎲 Shuffle Lines</button>
                <button class="btn" onclick="base64Encode()">🔐 Base64 Encode</button>
                <button class="btn" onclick="base64Decode()">🔓 Base64 Decode</button>
                <button class="btn" onclick="urlEncode()">🌐 URL Encode</button>
                <button class="btn" onclick="urlDecode()">🌐 URL Decode</button>
                <button class="btn" onclick="htmlEncode()">🔤 HTML Encode</button>
                <button class="btn" onclick="htmlDecode()">🔤 HTML Decode</button>
                <button class="btn" onclick="generatePassword()">🔑 Generate Password</button>
                <button class="btn" onclick="generateQR()">📱 Generate QR Code</button>
            </div>

            <div class="bbcode-section" style="margin-top: 30px;">
                <h3>📝 BBCode Generator</h3>
                <p>Tạo BBCode cho forum, blog và các trang web hỗ trợ</p>
                
                <div class="controls" style="margin-bottom: 20px;">
                    <button class="btn primary" onclick="generateBBCode('bold')">**Bold**</button>
                    <button class="btn primary" onclick="generateBBCode('italic')">*Italic*</button>
                    <button class="btn primary" onclick="generateBBCode('underline')">__Underline__</button>
                    <button class="btn primary" onclick="generateBBCode('strikethrough')">~~Strike~~</button>
                    <button class="btn warning" onclick="generateBBCode('color')">🎨 Color</button>
                    <button class="btn warning" onclick="generateBBCode('size')">📏 Size</button>
                    <button class="btn warning" onclick="generateBBCode('font')">🔤 Font</button>
                    <button class="btn success" onclick="generateBBCode('url')">🔗 Link</button>
                    <button class="btn success" onclick="generateBBCode('img')">🖼️ Image</button>
                    <button class="btn success" onclick="generateBBCode('quote')">💬 Quote</button>
                    <button class="btn" onclick="generateBBCode('code')">💻 Code</button>
                    <button class="btn" onclick="generateBBCode('list')">📋 List</button>
                    <button class="btn copy-btn" onclick="copyBBCode()">📋 Copy BBCode</button>
                </div>

                <div class="text-areas">
                    <div class="text-group">
                        <label for="bbcodeInput">📝 Input Text:</label>
                        <textarea 
                            id="bbcodeInput" 
                            placeholder="Nhập văn bản để tạo BBCode...&#10;&#10;Ví dụ: Hello World!"
                            style="height: 150px;"
                            oninput="previewBBCode()"
                        ></textarea>
                    </div>
                    
                    <div class="text-group">
                        <label for="bbcodeOutput">✨ BBCode Output:</label>
                        <textarea 
                            id="bbcodeOutput" 
                            placeholder="BBCode sẽ hiển thị ở đây..."
                            style="height: 150px;"
                            readonly
                        ></textarea>
                    </div>
                </div>

                <div class="bbcode-preview" style="margin-top: 20px;">
                    <h4>👁️ Preview (HTML):</h4>
                    <div id="bbcodePreview" style="border: 2px solid #e1e5e9; border-radius: 8px; padding: 20px; background: #f8f9fa; min-height: 100px;">
                        BBCode preview sẽ hiển thị ở đây...
                    </div>
                </div>
            </div>

            <div class="markdown-section" style="margin-top: 30px;">
                <h3>📄 Markdown Generator & Preview</h3>
                <p>Tạo và preview Markdown cho GitHub, documentation</p>
                
                <div class="controls" style="margin-bottom: 20px;">
                    <button class="btn primary" onclick="generateMarkdown('h1')">H1</button>
                    <button class="btn primary" onclick="generateMarkdown('h2')">H2</button>
                    <button class="btn primary" onclick="generateMarkdown('h3')">H3</button>
                    <button class="btn primary" onclick="generateMarkdown('bold')">**Bold**</button>
                    <button class="btn primary" onclick="generateMarkdown('italic')">*Italic*</button>
                    <button class="btn warning" onclick="generateMarkdown('link')">🔗 Link</button>
                    <button class="btn warning" onclick="generateMarkdown('image')">🖼️ Image</button>
                    <button class="btn success" onclick="generateMarkdown('code')">💻 Code</button>
                    <button class="btn success" onclick="generateMarkdown('codeblock')">📄 Code Block</button>
                    <button class="btn" onclick="generateMarkdown('list')">📋 List</button>
                    <button class="btn" onclick="generateMarkdown('table')">📊 Table</button>
                    <button class="btn copy-btn" onclick="copyMarkdown()">📋 Copy Markdown</button>
                </div>

                <div class="text-areas">
                    <div class="text-group">
                        <label for="markdownInput">📝 Markdown Input:</label>
                        <textarea 
                            id="markdownInput" 
                            placeholder="# Hello World&#10;&#10;This is **bold** and *italic* text.&#10;&#10;- List item 1&#10;- List item 2"
                            style="height: 200px;"
                            oninput="previewMarkdown()"
                        ></textarea>
                    </div>
                    
                    <div class="text-group">
                        <label for="markdownPreview">👁️ HTML Preview:</label>
                        <div id="markdownPreview" style="height: 200px; overflow-y: auto; border: 2px solid #e1e5e9; border-radius: 8px; padding: 20px; background: white;">
                            Markdown preview sẽ hiển thị ở đây...
                        </div>
                    </div>
                </div>
            </div>

            <div class="generators-section" style="margin-top: 30px;">
                <h3>🎲 Generators & Utilities</h3>
                
                <div class="generator-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                    <!-- Password Generator -->
                    <div class="generator-card" style="border: 2px solid #e1e5e9; border-radius: 12px; padding: 20px; background: #f8f9fa;">
                        <h4>🔑 Password Generator</h4>
                        <div style="margin: 15px 0;">
                            <label>
                                <input type="checkbox" id="includeUppercase" checked> Uppercase (A-Z)
                            </label><br>
                            <label>
                                <input type="checkbox" id="includeLowercase" checked> Lowercase (a-z)
                            </label><br>
                            <label>
                                <input type="checkbox" id="includeNumbers" checked> Numbers (0-9)
                            </label><br>
                            <label>
                                <input type="checkbox" id="includeSymbols"> Symbols (!@#$...)
                            </label><br>
                            <label>
                                Length: <input type="number" id="passwordLength" value="12" min="4" max="128" style="width: 60px;">
                            </label>
                        </div>
                        <button class="btn primary" onclick="generateRandomPassword()">Generate Password</button>
                        <button class="btn copy-btn" onclick="copyPassword()">📋 Copy</button>
                        <div id="generatedPassword" style="margin-top: 10px; padding: 10px; background: white; border-radius: 6px; font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace; word-break: break-all; min-height: 20px;"></div>
                    </div>

                    <!-- QR Code Generator -->
                    <div class="generator-card" style="border: 2px solid #e1e5e9; border-radius: 12px; padding: 20px; background: #f8f9fa;">
                        <h4>📱 QR Code Generator</h4>
                        <div style="margin: 15px 0;">
                            <input type="text" id="qrText" placeholder="Nhập text/URL để tạo QR code..." style="width: 100%; padding: 8px; margin-bottom: 10px;">
                            <label>
                                Size: 
                                <select id="qrSize" style="margin-left: 5px;">
                                    <option value="150">150x150</option>
                                    <option value="200" selected>200x200</option>
                                    <option value="300">300x300</option>
                                    <option value="400">400x400</option>
                                </select>
                            </label>
                        </div>
                        <button class="btn primary" onclick="generateQRCode()">Generate QR</button>
                        <button class="btn" onclick="downloadQR()">💾 Download</button>
                        <div id="qrResult" style="margin-top: 15px; text-align: center; min-height: 50px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Teen code mapping
        const teenCodeMap = {
            'a': ['4', '@', 'á', 'à', 'ả', 'ã', 'ạ', 'ă', 'ắ', 'ằ', 'ẳ', 'ẵ', 'ặ', 'â', 'ấ', 'ầ', 'ẩ', 'ẫ', 'ậ'],
            'e': ['3', 'é', 'è', 'ẻ', 'ẽ', 'ẹ', 'ê', 'ế', 'ề', 'ể', 'ễ', 'ệ'],
            'i': ['1', '!', 'í', 'ì', 'ỉ', 'ĩ', 'ị'],
            'o': ['0', 'ó', 'ò', 'ỏ', 'õ', 'ọ', 'ô', 'ố', 'ồ', 'ổ', 'ỗ', 'ộ', 'ơ', 'ớ', 'ờ', 'ở', 'ỡ', 'ợ'],
            'u': ['ú', 'ù', 'ủ', 'ũ', 'ụ', 'ư', 'ứ', 'ừ', 'ử', 'ữ', 'ự'],
            's': ['5', '$'],
            't': ['7', '+'],
            'g': ['9'],
            'b': ['6'],
            'l': ['1'],
            'z': ['2'],
            'y': ['ý', 'ỳ', 'ỷ', 'ỹ', 'ỵ']
        };

        // Vietnamese accent removal mapping
        const accentMap = {
            'à': 'a', 'á': 'a', 'ạ': 'a', 'ả': 'a', 'ã': 'a', 
            'ă': 'a', 'ắ': 'a', 'ằ': 'a', 'ặ': 'a', 'ẳ': 'a', 'ẵ': 'a',
            'â': 'a', 'ấ': 'a', 'ầ': 'a', 'ậ': 'a', 'ẩ': 'a', 'ẫ': 'a',
            'è': 'e', 'é': 'e', 'ẹ': 'e', 'ẻ': 'e', 'ẽ': 'e',
            'ê': 'e', 'ề': 'e', 'ế': 'e', 'ệ': 'e', 'ể': 'e', 'ễ': 'e',
            'ì': 'i', 'í': 'i', 'ị': 'i', 'ỉ': 'i', 'ĩ': 'i',
            'ò': 'o', 'ó': 'o', 'ọ': 'o', 'ỏ': 'o', 'õ': 'o',
            'ô': 'o', 'ồ': 'o', 'ố': 'o', 'ộ': 'o', 'ổ': 'o', 'ỗ': 'o',
            'ơ': 'o', 'ờ': 'o', 'ớ': 'o', 'ợ': 'o', 'ở': 'o', 'ỡ': 'o',
            'ù': 'u', 'ú': 'u', 'ụ': 'u', 'ủ': 'u', 'ũ': 'u',
            'ư': 'u', 'ừ': 'u', 'ứ': 'u', 'ự': 'u', 'ử': 'u', 'ữ': 'u',
            'ỳ': 'y', 'ý': 'y', 'ỵ': 'y', 'ỷ': 'y', 'ỹ': 'y',
            'đ': 'd'
        };

        function transformText(type) {
            const input = document.getElementById('inputText').value;
            let output = '';

            switch (type) {
                case 'lowercase':
                    output = input.toLowerCase();
                    break;

                case 'uppercase':
                    output = input.toUpperCase();
                    break;

                case 'capitalize':
                    output = input.replace(/\w\S*/g, txt => 
                        txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()
                    );
                    break;

                case 'sentence':
                    output = input.toLowerCase().replace(/(^\s*\w|[.!?]\s*\w)/g, txt => 
                        txt.toUpperCase()
                    );
                    break;

                case 'strikethrough':
                    output = input.split('').map(char => 
                        char.trim() !== '' ? char + '\u0336' : char
                    ).join('');
                    break;

                case 'underline':
                    output = input.split('').map(char => 
                        char.trim() !== '' ? char + '\u0332' : char
                    ).join('');
                    break;

                case 'teencode':
                    output = input.toLowerCase().split('').map(char => {
                        if (teenCodeMap[char]) {
                            return teenCodeMap[char][Math.floor(Math.random() * teenCodeMap[char].length)];
                        }
                        return char;
                    }).join('');
                    break;

                case 'reverse':
                    output = input.split('').reverse().join('');
                    break;

                case 'removeAccents':
                    output = input.split('').map(char => {
                        const lowerChar = char.toLowerCase();
                        if (accentMap[lowerChar]) {
                            return char === lowerChar ? accentMap[lowerChar] : accentMap[lowerChar].toUpperCase();
                        }
                        return char;
                    }).join('');
                    break;

                case 'alternating':
                    output = input.split('').map((char, index) => 
                        index % 2 === 0 ? char.toLowerCase() : char.toUpperCase()
                    ).join('');
                    break;

                case 'removeSpaces':
                    output = input.replace(/\s+/g, '');
                    break;

                case 'addSpaces':
                    output = input.split('').join(' ');
                    break;

                default:
                    output = input;
            }

            document.getElementById('outputText').value = output;
            showNotification('✅ Chuyển đổi thành công!');
        }

        function copyToClipboard() {
            const output = document.getElementById('outputText');
            output.select();
            output.setSelectionRange(0, 99999);
            
            try {
                document.execCommand('copy');
                showNotification('📋 Đã copy vào clipboard!');
            } catch (err) {
                showNotification('❌ Không thể copy! Vui lòng thử lại.');
            }
        }

        function clearAll() {
            document.getElementById('inputText').value = '';
            document.getElementById('outputText').value = '';
            updateStats();
            showNotification('🗑️ Đã xóa tất cả!');
        }

        function swapText() {
            const input = document.getElementById('inputText');
            const output = document.getElementById('outputText');
            
            const temp = input.value;
            input.value = output.value;
            output.value = temp;
            
            updateStats();
            showNotification('🔄 Đã hoán đổi văn bản!');
        }

        function updateStats() {
            const text = document.getElementById('inputText').value;
            
            const charCount = text.length;
            const wordCount = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
            const lineCount = text === '' ? 0 : text.split('\n').length;
            const sentenceCount = text.trim() === '' ? 0 : text.split(/[.!?]+/).filter(s => s.trim().length > 0).length;
            
            document.getElementById('charCount').textContent = charCount.toLocaleString();
            document.getElementById('wordCount').textContent = wordCount.toLocaleString();
            document.getElementById('lineCount').textContent = lineCount.toLocaleString();
            document.getElementById('sentenceCount').textContent = sentenceCount.toLocaleString();
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Initialize stats on page load
        document.addEventListener('DOMContentLoaded', () => {
            updateStats();
            
            // Add keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey) {
                    switch (e.key) {
                        case 'l':
                            e.preventDefault();
                            transformText('lowercase');
                            break;
                        case 'u':
                            e.preventDefault();
                            transformText('uppercase');
                            break;
                        case 'Enter':
                            e.preventDefault();
                            copyToClipboard();
                            break;
                    }
                }
            });
        });

        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Diff comparison functionality
        function performDiff() {
            const text1 = document.getElementById('diffText1').value;
            const text2 = document.getElementById('diffText2').value;
            
            if (!text1 && !text2) {
                document.getElementById('diffOutput').innerHTML = 
                    '<div style="padding: 20px; color: #6c757d;">Nhập văn bản vào cả hai ô phía trên để xem kết quả so sánh...</div>';
                return;
            }
            
            const lines1 = text1.split('\n');
            const lines2 = text2.split('\n');
            const diffResult = computeDiff(lines1, lines2);
            
            displayDiff(diffResult);
        }

        function computeDiff(lines1, lines2) {
            const maxLen = Math.max(lines1.length, lines2.length);
            const result = [];
            
            for (let i = 0; i < maxLen; i++) {
                const line1 = lines1[i] || '';
                const line2 = lines2[i] || '';
                
                if (line1 === line2) {
                    result.push({ type: 'unchanged', content: line1, lineNum1: i + 1, lineNum2: i + 1 });
                } else {
                    if (lines1[i] !== undefined && lines2[i] === undefined) {
                        result.push({ type: 'removed', content: line1, lineNum1: i + 1, lineNum2: null });
                    } else if (lines1[i] === undefined && lines2[i] !== undefined) {
                        result.push({ type: 'added', content: line2, lineNum1: null, lineNum2: i + 1 });
                    } else {
                        result.push({ type: 'removed', content: line1, lineNum1: i + 1, lineNum2: null });
                        result.push({ type: 'added', content: line2, lineNum1: null, lineNum2: i + 1 });
                    }
                }
            }
            
            return result;
        }

        function displayDiff(diffResult) {
            const output = document.getElementById('diffOutput');
            let html = '';
            
            diffResult.forEach(line => {
                const lineNumbers = line.lineNum1 && line.lineNum2 
                    ? `${line.lineNum1}:${line.lineNum2}` 
                    : line.lineNum1 
                        ? `${line.lineNum1}:-`
                        : `-:${line.lineNum2}`;
                
                html += `<div class="diff-line ${line.type}">
                    <span style="color: #999; margin-right: 10px; font-size: 12px;">${lineNumbers}</span>
                    ${escapeHtml(line.content)}
                </div>`;
            });
            
            output.innerHTML = html;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function clearDiff() {
            document.getElementById('diffText1').value = '';
            document.getElementById('diffText2').value = '';
            document.getElementById('diffOutput').innerHTML = 
                '<div style="padding: 20px; color: #6c757d;">Nhập văn bản vào cả hai ô phía trên để xem kết quả so sánh...</div>';
            showNotification('🗑️ Đã xóa tất cả văn bản!');
        }

        function downloadDiff() {
            const diffOutput = document.getElementById('diffOutput').innerText;
            const blob = new Blob([diffOutput], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'diff-result.txt';
            a.click();
            URL.revokeObjectURL(url);
            showNotification('💾 Đã tải xuống kết quả so sánh!');
        }

        // File loading functionality
        function loadFile(targetId, input) {
            const file = input.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById(targetId).value = e.target.result;
                if (targetId.includes('diff')) {
                    performDiff();
                }
                showNotification(`📁 Đã tải file: ${file.name}`);
            };
            reader.readAsText(file);
        }

        // Code editor functionality
        const codeTemplates = {
            html: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Hello World!</h1>
</body>
</html>`,
            css: `body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
}

.container {
    max-width: 800px;
    margin: 0 auto;
}

h1 {
    color: #333;
    text-align: center;
}`,
            javascript: `// JavaScript Example
function greetUser(name) {
    console.log(\`Hello, \${name}!\`);
    return \`Welcome, \${name}!\`;
}

// Call the function
const userName = "World";
const message = greetUser(userName);
document.body.innerHTML = message;`,
            python: `# Python Example
def greet_user(name):
    """Greet a user with their name"""
    print(f"Hello, {name}!")
    return f"Welcome, {name}!"

# Call the function
user_name = "World"
message = greet_user(user_name)
print(message)`,
            json: `{
    "name": "Text Transformer Pro",
    "version": "1.0.0",
    "description": "A powerful text transformation tool",
    "features": [
        "Text transformation",
        "Diff comparison", 
        "Code editor",
        "Advanced tools"
    ],
    "author": "Developer",
    "license": "MIT"
}`
        };

        function changeLanguage() {
            const language = document.getElementById('languageSelect').value;
            const editor = document.getElementById('codeEditor');
            
            if (codeTemplates[language] && !editor.value.trim()) {
                editor.value = codeTemplates[language];
            }
            
            updatePreview();
            showNotification(`🔄 Đã chuyển sang ngôn ngữ: ${language.toUpperCase()}`);
        }

        function updatePreview() {
            const code = document.getElementById('codeEditor').value;
            const language = document.getElementById('languageSelect').value;
            const preview = document.getElementById('codePreview');
            
            // Basic syntax highlighting (simplified)
            let highlightedCode = escapeHtml(code);
            
            // Simple highlighting patterns
            if (language === 'html') {
                highlightedCode = highlightedCode
                    .replace(/(&lt;\/?[^&gt;]+&gt;)/g, '<span style="color: #e06c75;">$1</span>')
                    .replace(/(\w+)=/g, '<span style="color: #61afef;">$1</span>=');
            } else if (language === 'css') {
                highlightedCode = highlightedCode
                    .replace(/([.#]?[\w-]+)\s*{/g, '<span style="color: #e06c75;">$1</span> {')
                    .replace(/([\w-]+):/g, '<span style="color: #61afef;">$1</span>:');
            } else if (language === 'javascript' || language === 'typescript') {
                highlightedCode = highlightedCode
                    .replace(/\b(function|var|let|const|if|else|for|while|return|class|import|export)\b/g, '<span style="color: #c678dd;">$1</span>')
                    .replace(/\/\/.*$/gm, '<span style="color: #5c6370;">$&</span>');
            } else if (language === 'python') {
                highlightedCode = highlightedCode
                    .replace(/\b(def|class|if|else|elif|for|while|return|import|from|try|except)\b/g, '<span style="color: #c678dd;">$1</span>')
                    .replace(/#.*$/gm, '<span style="color: #5c6370;">$&</span>');
            }
            
            preview.innerHTML = highlightedCode;
        }

        function handleTab(event) {
            if (event.key === 'Tab') {
                event.preventDefault();
                const textarea = event.target;
                const start = textarea.selectionStart;
                const end = textarea.selectionEnd;
                
                textarea.value = textarea.value.substring(0, start) + '    ' + textarea.value.substring(end);
                textarea.selectionStart = textarea.selectionEnd = start + 4;
                
                updatePreview();
            }
        }

        function loadCodeFile(input) {
            const file = input.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('codeEditor').value = e.target.result;
                
                // Auto-detect language from file extension
                const ext = file.name.split('.').pop().toLowerCase();
                const languageMap = {
                    'html': 'html', 'htm': 'html',
                    'css': 'css',
                    'js': 'javascript', 'jsx': 'javascript',
                    'ts': 'typescript', 'tsx': 'typescript',
                    'py': 'python',
                    'json': 'json',
                    'xml': 'xml',
                    'sql': 'sql',
                    'php': 'php',
                    'java': 'java',
                    'cpp': 'cpp', 'c': 'cpp', 'h': 'cpp',
                    'cs': 'csharp'
                };
                
                if (languageMap[ext]) {
                    document.getElementById('languageSelect').value = languageMap[ext];
                }
                
                updatePreview();
                showNotification(`📁 Đã tải file code: ${file.name}`);
            };
            reader.readAsText(file);
        }

        function downloadCode() {
            const code = document.getElementById('codeEditor').value;
            const language = document.getElementById('languageSelect').value;
            const extensions = {
                'html': 'html', 'css': 'css', 'javascript': 'js', 'typescript': 'ts',
                'python': 'py', 'json': 'json', 'xml': 'xml', 'sql': 'sql',
                'php': 'php', 'java': 'java', 'cpp': 'cpp', 'csharp': 'cs'
            };
            
            const blob = new Blob([code], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `code.${extensions[language] || 'txt'}`;
            a.click();
            URL.revokeObjectURL(url);
            showNotification('💾 Đã tải xuống code!');
        }

        function formatCode() {
            const code = document.getElementById('codeEditor').value;
            const language = document.getElementById('languageSelect').value;
            
            let formatted = code;
            
            if (language === 'json') {
                try {
                    const parsed = JSON.parse(code);
                    formatted = JSON.stringify(parsed, null, 2);
                } catch (e) {
                    showNotification('❌ JSON không hợp lệ!');
                    return;
                }
            }
            
            document.getElementById('codeEditor').value = formatted;
            updatePreview();
            showNotification('✨ Đã format code!');
        }

        function runCode() {
            const code = document.getElementById('codeEditor').value;
            const language = document.getElementById('languageSelect').value;
            
            if (language === 'html') {
                const newWindow = window.open();
                newWindow.document.write(code);
                newWindow.document.close();
                showNotification('▶️ Đã chạy HTML trong tab mới!');
            } else if (language === 'javascript') {
                try {
                    const result = eval(code);
                    showNotification('▶️ Code đã chạy! Check console.');
                    console.log('Result:', result);
                } catch (e) {
                    showNotification('❌ Lỗi: ' + e.message);
                }
            } else {
                showNotification('⚠️ Chức năng chạy code chỉ hỗ trợ HTML và JavaScript!');
            }
        }

        function clearCode() {
            document.getElementById('codeEditor').value = '';
            document.getElementById('codePreview').innerHTML = '';
            showNotification('🗑️ Đã xóa tất cả code!');
        }

        function copyCode() {
            const code = document.getElementById('codeEditor').value;
            navigator.clipboard.writeText(code).then(() => {
                showNotification('📋 Đã copy code vào clipboard!');
            });
        }

        // Advanced tools functionality
        function extractEmails() {
            const text = document.getElementById('toolsInput').value;
            const emailRegex = /\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g;
            const emails = text.match(emailRegex) || [];
            document.getElementById('toolsOutput').value = emails.join('\n');
            showNotification(`📧 Tìm thấy ${emails.length} email(s)!`);
        }

        function extractUrls() {
            const text = document.getElementById('toolsInput').value;
            const urlRegex = /https?:\/\/[^\s]+/g;
            const urls = text.match(urlRegex) || [];
            document.getElementById('toolsOutput').value = urls.join('\n');
            showNotification(`🔗 Tìm thấy ${urls.length} URL(s)!`);
        }

        function extractNumbers() {
            const text = document.getElementById('toolsInput').value;
            const numberRegex = /\d+(?:\.\d+)?/g;
            const numbers = text.match(numberRegex) || [];
            document.getElementById('toolsOutput').value = numbers.join('\n');
            showNotification(`🔢 Tìm thấy ${numbers.length} số!`);
        }

        function wordFrequency() {
            const text = document.getElementById('toolsInput').value.toLowerCase();
            const words = text.match(/\b\w+\b/g) || [];
            const frequency = {};
            
            words.forEach(word => {
                frequency[word] = (frequency[word] || 0) + 1;
            });
            
            const sorted = Object.entries(frequency)
                .sort((a, b) => b[1] - a[1])
                .map(([word, count]) => `${word}: ${count}`)
                .join('\n');
            
            document.getElementById('toolsOutput').value = sorted;
            showNotification('📊 Đã phân tích tần suất từ!');
        }

        function removeEmptyLines() {
            const text = document.getElementById('toolsInput').value;
            const result = text.split('\n').filter(line => line.trim() !== '').join('\n');
            document.getElementById('toolsOutput').value = result;
            showNotification('📝 Đã xóa các dòng trống!');
        }

        function removeDuplicates() {
            const text = document.getElementById('toolsInput').value;
            const lines = text.split('\n');
            const unique = [...new Set(lines)];
            document.getElementById('toolsOutput').value = unique.join('\n');
            showNotification('🔄 Đã xóa các dòng trùng lặp!');
        }

        function sortLines() {
            const text = document.getElementById('toolsInput').value;
            const lines = text.split('\n').sort();
            document.getElementById('toolsOutput').value = lines.join('\n');
            showNotification('📋 Đã sắp xếp các dòng!');
        }

        function shuffleLines() {
            const text = document.getElementById('toolsInput').value;
            const lines = text.split('\n');
            for (let i = lines.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [lines[i], lines[j]] = [lines[j], lines[i]];
            }
            document.getElementById('toolsOutput').value = lines.join('\n');
            showNotification('🎲 Đã xáo trộn các dòng!');
        }

        function base64Encode() {
            const text = document.getElementById('toolsInput').value;
            const encoded = btoa(unescape(encodeURIComponent(text)));
            document.getElementById('toolsOutput').value = encoded;
            showNotification('🔐 Đã mã hóa Base64!');
        }

        function base64Decode() {
            const text = document.getElementById('toolsInput').value;
            try {
                const decoded = decodeURIComponent(escape(atob(text)));
                document.getElementById('toolsOutput').value = decoded;
                showNotification('🔓 Đã giải mã Base64!');
            } catch (e) {
                showNotification('❌ Dữ liệu Base64 không hợp lệ!');
            }
        }

        function urlEncode() {
            const text = document.getElementById('toolsInput').value;
            const encoded = encodeURIComponent(text);
            document.getElementById('toolsOutput').value = encoded;
            showNotification('🌐 Đã mã hóa URL!');
        }

        function urlDecode() {
            const text = document.getElementById('toolsInput').value;
            try {
                const decoded = decodeURIComponent(text);
                document.getElementById('toolsOutput').value = decoded;
                showNotification('🌐 Đã giải mã URL!');
            } catch (e) {
                showNotification('❌ Dữ liệu URL không hợp lệ!');
            }
        }

        // Find and replace functionality
        function findText() {
            const findStr = document.getElementById('findText').value;
            const targetText = document.getElementById('toolsInput').value;
            
            if (!findStr) {
                showNotification('⚠️ Vui lòng nhập từ cần tìm!');
                return;
            }
            
            const regex = document.getElementById('regexMode').checked 
                ? new RegExp(findStr, document.getElementById('caseSensitive').checked ? 'g' : 'gi')
                : new RegExp(findStr.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), document.getElementById('caseSensitive').checked ? 'g' : 'gi');
            
            const matches = targetText.match(regex);
            const count = matches ? matches.length : 0;
            
            showNotification(`🔍 Tìm thấy ${count} kết quả!`);
        }

        function replaceText() {
            const findStr = document.getElementById('findText').value;
            const replaceStr = document.getElementById('replaceText').value;
            const targetText = document.getElementById('toolsInput').value;
            
            if (!findStr) {
                showNotification('⚠️ Vui lòng nhập từ cần tìm!');
                return;
            }
            
            const regex = document.getElementById('regexMode').checked 
                ? new RegExp(findStr, document.getElementById('caseSensitive').checked ? '' : 'i')
                : new RegExp(findStr.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), document.getElementById('caseSensitive').checked ? '' : 'i');
            
            const result = targetText.replace(regex, replaceStr);
            document.getElementById('toolsOutput').value = result;
            showNotification('🔄 Đã thay thế văn bản!');
        }

        function replaceAll() {
            const findStr = document.getElementById('findText').value;
            const replaceStr = document.getElementById('replaceText').value;
            const targetText = document.getElementById('toolsInput').value;
            
            if (!findStr) {
                showNotification('⚠️ Vui lòng nhập từ cần tìm!');
                return;
            }
            
            const regex = document.getElementById('regexMode').checked 
                ? new RegExp(findStr, document.getElementById('caseSensitive').checked ? 'g' : 'gi')
                : new RegExp(findStr.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), document.getElementById('caseSensitive').checked ? 'g' : 'gi');
            
            const result = targetText.replace(regex, replaceStr);
            document.getElementById('toolsOutput').value = result;
            showNotification('🔄 Đã thay thế tất cả!');
        }

        function highlightMatches() {
            const findStr = document.getElementById('findText').value;
            const targetText = document.getElementById('toolsInput').value;
            
            if (!findStr) {
                showNotification('⚠️ Vui lòng nhập từ cần tìm!');
                return;
            }
            
            const regex = document.getElementById('regexMode').checked 
                ? new RegExp(findStr, document.getElementById('caseSensitive').checked ? 'g' : 'gi')
                : new RegExp(findStr.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), document.getElementById('caseSensitive').checked ? 'g' : 'gi');
            
            const highlighted = targetText.replace(regex, '**$&**');
            document.getElementById('toolsOutput').value = highlighted;
            showNotification('🎯 Đã highlight các kết quả tìm kiếm!');
        }

        // HTML encoding/decoding
        function htmlEncode() {
            const text = document.getElementById('toolsInput').value;
            const encoded = text
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#39;');
            document.getElementById('toolsOutput').value = encoded;
            showNotification('🔤 Đã encode HTML entities!');
        }

        function htmlDecode() {
            const text = document.getElementById('toolsInput').value;
            const decoded = text
                .replace(/&amp;/g, '&')
                .replace(/&lt;/g, '<')
                .replace(/&gt;/g, '>')
                .replace(/&quot;/g, '"')
                .replace(/&#39;/g, "'");
            document.getElementById('toolsOutput').value = decoded;
            showNotification('🔤 Đã decode HTML entities!');
        }

        // BBCode functionality
        function generateBBCode(type) {
            const input = document.getElementById('bbcodeInput').value;
            const selectedText = getSelectedText('bbcodeInput') || input || 'Sample text';
            let bbcode = '';

            switch (type) {
                case 'bold':
                    bbcode = `[b]${selectedText}[/b]`;
                    break;
                case 'italic':
                    bbcode = `[i]${selectedText}[/i]`;
                    break;
                case 'underline':
                    bbcode = `[u]${selectedText}[/u]`;
                    break;
                case 'strikethrough':
                    bbcode = `[s]${selectedText}[/s]`;
                    break;
                case 'color':
                    const color = prompt('Nhập màu (ví dụ: red, #FF0000):', 'red');
                    bbcode = color ? `[color=${color}]${selectedText}[/color]` : selectedText;
                    break;
                case 'size':
                    const size = prompt('Nhập kích thước (8-36):', '14');
                    bbcode = size ? `[size=${size}]${selectedText}[/size]` : selectedText;
                    break;
                case 'font':
                    const font = prompt('Nhập font (ví dụ: Arial, Times):', 'Arial');
                    bbcode = font ? `[font=${font}]${selectedText}[/font]` : selectedText;
                    break;
                case 'url':
                    const url = prompt('Nhập URL:', 'https://example.com');
                    bbcode = url ? `[url=${url}]${selectedText}[/url]` : selectedText;
                    break;
                case 'img':
                    const imgUrl = prompt('Nhập URL hình ảnh:', 'https://example.com/image.jpg');
                    bbcode = imgUrl ? `[img]${imgUrl}[/img]` : '[img]URL_IMAGE[/img]';
                    break;
                case 'quote':
                    const author = prompt('Tác giả (tùy chọn):', '');
                    bbcode = author ? `[quote=${author}]${selectedText}[/quote]` : `[quote]${selectedText}[/quote]`;
                    break;
                case 'code':
                    bbcode = `[code]${selectedText}[/code]`;
                    break;
                case 'list':
                    const items = selectedText.split('\n').filter(line => line.trim());
                    bbcode = '[list]\n' + items.map(item => `[*]${item.trim()}`).join('\n') + '\n[/list]';
                    break;
            }

            document.getElementById('bbcodeOutput').value = bbcode;
            previewBBCode();
            showNotification(`📝 Đã tạo BBCode: ${type}!`);
        }

        function previewBBCode() {
            const bbcode = document.getElementById('bbcodeOutput').value;
            let html = bbcode;

            // Convert BBCode to HTML
            html = html
                .replace(/\[b\](.*?)\[\/b\]/gi, '<strong>$1</strong>')
                .replace(/\[i\](.*?)\[\/i\]/gi, '<em>$1</em>')
                .replace(/\[u\](.*?)\[\/u\]/gi, '<u>$1</u>')
                .replace(/\[s\](.*?)\[\/s\]/gi, '<del>$1</del>')
                .replace(/\[color=([^\]]+)\](.*?)\[\/color\]/gi, '<span style="color: $1;">$2</span>')
                .replace(/\[size=([^\]]+)\](.*?)\[\/size\]/gi, '<span style="font-size: $1px;">$2</span>')
                .replace(/\[font=([^\]]+)\](.*?)\[\/font\]/gi, '<span style="font-family: $1;">$2</span>')
                .replace(/\[url=([^\]]+)\](.*?)\[\/url\]/gi, '<a href="$1" target="_blank">$2</a>')
                .replace(/\[url\](.*?)\[\/url\]/gi, '<a href="$1" target="_blank">$1</a>')
                .replace(/\[img\](.*?)\[\/img\]/gi, '<img src="$1" alt="Image" style="max-width: 100%; height: auto;">')
                .replace(/\[quote=([^\]]+)\](.*?)\[\/quote\]/gi, '<blockquote><cite>$1 wrote:</cite><br>$2</blockquote>')
                .replace(/\[quote\](.*?)\[\/quote\]/gi, '<blockquote>$2</blockquote>')
                .replace(/\[code\](.*?)\[\/code\]/gi, '<pre><code>$1</code></pre>')
                .replace(/\[list\](.*?)\[\/list\]/gi, '<ul>$1</ul>')
                .replace(/\[\*\](.*?)(?=\[\*\]|\[\/list\]|$)/gi, '<li>$1</li>')
                .replace(/\n/g, '<br>');

            document.getElementById('bbcodePreview').innerHTML = html || 'BBCode preview sẽ hiển thị ở đây...';
        }

        function copyBBCode() {
            const bbcode = document.getElementById('bbcodeOutput').value;
            navigator.clipboard.writeText(bbcode).then(() => {
                showNotification('📋 Đã copy BBCode vào clipboard!');
            });
        }

        // Markdown functionality
        function generateMarkdown(type) {
            const input = document.getElementById('markdownInput').value;
            const selectedText = getSelectedText('markdownInput') || 'Sample text';
            let markdown = '';

            switch (type) {
                case 'h1':
                    markdown = `# ${selectedText}`;
                    break;
                case 'h2':
                    markdown = `## ${selectedText}`;
                    break;
                case 'h3':
                    markdown = `### ${selectedText}`;
                    break;
                case 'bold':
                    markdown = `**${selectedText}**`;
                    break;
                case 'italic':
                    markdown = `*${selectedText}*`;
                    break;
                case 'link':
                    const url = prompt('Nhập URL:', 'https://example.com');
                    markdown = url ? `[${selectedText}](${url})` : selectedText;
                    break;
                case 'image':
                    const imgUrl = prompt('Nhập URL hình ảnh:', 'https://example.com/image.jpg');
                    const alt = prompt('Alt text:', selectedText);
                    markdown = imgUrl ? `![${alt}](${imgUrl})` : selectedText;
                    break;
                case 'code':
                    markdown = `\`${selectedText}\``;
                    break;
                case 'codeblock':
                    const lang = prompt('Ngôn ngữ (tùy chọn):', 'javascript');
                    markdown = `\`\`\`${lang}\n${selectedText}\n\`\`\``;
                    break;
                case 'list':
                    const items = selectedText.split('\n').filter(line => line.trim());
                    markdown = items.map(item => `- ${item.trim()}`).join('\n');
                    break;
                case 'table':
                    markdown = `| Header 1 | Header 2 | Header 3 |\n|----------|----------|----------|\n| Cell 1   | Cell 2   | Cell 3   |\n| Cell 4   | Cell 5   | Cell 6   |`;
                    break;
            }

            const currentInput = document.getElementById('markdownInput');
            if (currentInput.selectionStart !== currentInput.selectionEnd) {
                // Replace selected text
                const start = currentInput.selectionStart;
                const end = currentInput.selectionEnd;
                const value = currentInput.value;
                currentInput.value = value.substring(0, start) + markdown + value.substring(end);
            } else {
                // Append to current content
                currentInput.value += (currentInput.value ? '\n' : '') + markdown;
            }

            previewMarkdown();
            showNotification(`📄 Đã thêm Markdown: ${type}!`);
        }

        function previewMarkdown() {
            const markdown = document.getElementById('markdownInput').value;
            let html = markdown;

            // Simple Markdown to HTML conversion
            html = html
                .replace(/^### (.*$)/gim, '<h3>$1</h3>')
                .replace(/^## (.*$)/gim, '<h2>$1</h2>')
                .replace(/^# (.*$)/gim, '<h1>$1</h1>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/!\[([^\]]*)\]\(([^)]+)\)/g, '<img src="$2" alt="$1" style="max-width: 100%; height: auto;">')
                .replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank">$1</a>')
                .replace(/`([^`]+)`/g, '<code>$1</code>')
                .replace(/```(\w+)?\n([\s\S]*?)```/g, '<pre><code>$2</code></pre>')
                .replace(/^- (.*$)/gim, '<li>$1</li>')
                .replace(/(<li>.*<\/li>)/s, '<ul>$1</ul>')
                .replace(/^\| (.*) \|$/gim, '<tr><td>$1</td></tr>')
                .replace(/(<tr>.*<\/tr>)/s, '<table border="1">$1</table>')
                .replace(/\n/g, '<br>');

            document.getElementById('markdownPreview').innerHTML = html || 'Markdown preview sẽ hiển thị ở đây...';
        }

        function copyMarkdown() {
            const markdown = document.getElementById('markdownInput').value;
            navigator.clipboard.writeText(markdown).then(() => {
                showNotification('📋 Đã copy Markdown vào clipboard!');
            });
        }

        // Password Generator
        function generateRandomPassword() {
            const length = parseInt(document.getElementById('passwordLength').value);
            const includeUppercase = document.getElementById('includeUppercase').checked;
            const includeLowercase = document.getElementById('includeLowercase').checked;
            const includeNumbers = document.getElementById('includeNumbers').checked;
            const includeSymbols = document.getElementById('includeSymbols').checked;

            let charset = '';
            if (includeUppercase) charset += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            if (includeLowercase) charset += 'abcdefghijklmnopqrstuvwxyz';
            if (includeNumbers) charset += '0123456789';
            if (includeSymbols) charset += '!@#$%^&*()_+-=[]{}|;:,.<>?';

            if (!charset) {
                showNotification('⚠️ Vui lòng chọn ít nhất một loại ký tự!');
                return;
            }

            let password = '';
            for (let i = 0; i < length; i++) {
                password += charset.charAt(Math.floor(Math.random() * charset.length));
            }

            document.getElementById('generatedPassword').textContent = password;
            showNotification(`🔑 Đã tạo password ${length} ký tự!`);
        }

        function copyPassword() {
            const password = document.getElementById('generatedPassword').textContent;
            if (password) {
                navigator.clipboard.writeText(password).then(() => {
                    showNotification('📋 Đã copy password vào clipboard!');
                });
            } else {
                showNotification('⚠️ Chưa có password để copy!');
            }
        }

        // QR Code Generator (using QR Server API)
        function generateQRCode() {
            const text = document.getElementById('qrText').value;
            const size = document.getElementById('qrSize').value;

            if (!text.trim()) {
                showNotification('⚠️ Vui lòng nhập text để tạo QR code!');
                return;
            }

            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=${size}x${size}&data=${encodeURIComponent(text)}`;
            
            document.getElementById('qrResult').innerHTML = `
                <img src="${qrUrl}" alt="QR Code" style="border: 2px solid #ddd; border-radius: 8px;">
                <p style="margin-top: 10px; font-size: 12px; color: #666;">QR Code cho: ${text.substring(0, 50)}${text.length > 50 ? '...' : ''}</p>
            `;

            showNotification('📱 Đã tạo QR Code thành công!');
        }

        function downloadQR() {
            const img = document.querySelector('#qrResult img');
            if (img) {
                const link = document.createElement('a');
                link.href = img.src;
                link.download = 'qrcode.png';
                link.click();
                showNotification('💾 Đã tải xuống QR Code!');
            } else {
                showNotification('⚠️ Chưa có QR Code để tải xuống!');
            }
        }

        // Helper function to get selected text
        function getSelectedText(textareaId) {
            const textarea = document.getElementById(textareaId);
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            return textarea.value.substring(start, end);
        }

        // Quick functions for backwards compatibility
        function generatePassword() {
            generateRandomPassword();
        }

        function generateQR() {
            generateQRCode();
        }
    </script>

    <!-- Prism.js for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
</body>
</html>
